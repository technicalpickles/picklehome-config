switch:
  - platform: template
    switches:
      fireplace:
        friendly_name: Fireplace
        value_template: >
           {{ is_state("media_player.kodi", "playing") }}
        turn_on:
          # use a script, because it runs asynchronously.
          # otherwise, when alexa-controlled, might timeout waiting for it to finish
          - service: script.turn_on
            entity_id: script.fireplace_on
        turn_off:
          - service: media_player.turn_off
            entity_id: media_player.kodi
          - service: light.turn_off
            entity_id: light.fireplace_backlight
